# Hermetica External Tools — Versions & Integration Notes

Retrieved on: <AUTO-GENERATED AT BUILD TIME>

This document captures the latest verified versions from official GitHub releases and the exact CLI flags Hermetica integrates with. All commands assume Linux and JSONL output where available.

## Summary (Latest Releases)
- subfinder: v2.8.0 (projectdiscovery/subfinder)
- dnsx: v1.2.2 (projectdiscovery/dnsx)
- naabu: v2.3.5 (projectdiscovery/naabu)
- httpx: v1.7.1 (projectdiscovery/httpx)
- katana: v1.2.1 (projectdiscovery/katana)
- gowitness: 3.0.5 (sensepost/gowitness)

Notes
- ProjectDiscovery binaries support `-update` and `-disable-update-check`; Hermetica will not auto-update tools.
- Hermetica validates minimum versions in `configs/hermetica.yaml` and via `hermetica doctor`.

---

## subfinder (Passive subdomains)
- Repo: https://github.com/projectdiscovery/subfinder
- Latest: v2.8.0
- JSON output flag: `-json` (alias shown as `-oJ, -json`)

Planned invocation
```
subfinder \
  -silent \
  -all \
  -d <domain> \
  -pc <provider-config.yaml> \
  -json
```

Integration notes
- Reads env/provider keys from `-pc` provider config.
- Streams JSONL, parse per line. Use `-silent` to only emit data rows.
- Dry-run check: `subfinder -h` or `subfinder -version`.

---

## dnsx (Resolution + records)
- Repo: https://github.com/projectdiscovery/dnsx
- Latest: v1.2.2
- JSON output flag: `-json` (short `-j`)

Planned invocation
```
dnsx \
  -l <subdomains.txt> \
  -a -aaaa -cname \
  -resp \
  -retry 2 \
  -r <resolvers.txt> \
  -json
```

Integration notes
- `-resp` prints record values in human output; JSONL includes structured fields (a, aaaa, cname, etc.).
- Hermetica performs its own wildcard detection; dnsx wildcard flags are not used.
- Dry-run check: `dnsx -hc` (health-check).

---

## naabu (Port scanning)
- Repo: https://github.com/projectdiscovery/naabu
- Latest: v2.3.5
- JSON output flag: `-json`
- Scan type flag: `-s SYN|CONNECT` via `-scan-type`

Planned invocation
- Full TCP range, adaptive rate controlled externally by Hermetica.
```
# Thorough profile (SYN) — requires CAP_NET_RAW
naabu \
  -list <ips.txt> \
  -p - \
  -s s \
  -rate <rate> \
  -json

# Stealth profile (CONNECT)
naabu \
  -list <ips.txt> \
  -p - \
  -s c \
  -rate <rate> \
  -json
```

Integration notes
- `-p -` scans all ports. Use `-exclude-ports` if needed by policy.
- Hermetica adjusts `-rate` dynamically (adaptive backoff) based on observed loss/timeouts.
- IPv6 scanning is optional; Hermetica honors `ipv6_enabled`.
- Dry-run check: `naabu -h` or `naabu -version`.

---

## httpx (HTTP probing)
- Repo: https://github.com/projectdiscovery/httpx
- Latest: v1.7.1
- JSON output flag: `-json`
- SNI override: `-sni <name>`
- Host header: `-H "Host: <name>"`

Planned invocations
- Base flags provide titles, status, tech, TLS certs, follow redirects.
```
httpx \
  -json \
  -fr -title -sc -tech-detect -tls-grab \
  -no-color -silent \
  -retries <n> -timeout <sec>
```
- Matrix examples (given `ip:port` and `domain`):
```
# SNI=subdomain, Host=subdomain (standard)
... -sni <domain> -H "Host: <domain>" -- ...

# SNI=subdomain, Host=blank (SNI-only)
... -sni <domain> -- ...

# SNI=blank, Host=subdomain (Host-only)
... -H "Host: <domain>" -- ...

# SNI=blank, Host=blank (direct IP)
... -- ...
```

Integration notes
- Input via stdin or `-list`. Hermetica feeds all open ports and targets.
- WAF-aware: use jitter, small retries; Hermetica limits concurrency and jitter per config.
- Dry-run check: `httpx -hc` (health-check) or `httpx -version`.

---

## katana (Crawling; optional)
- Repo: https://github.com/projectdiscovery/katana
- Latest: v1.2.1
- JSON output flag: `-jsonl` (note: not `-json`)

Planned invocation
```
katana \
  -silent -jsonl -no-color \
  -concurrency <n> \
  -timeout <sec> \
  -list <live_urls.txt>
```

Integration notes
- Target selection: only crawl unique apps (Hermetica deduping by body hash / page group).
- Scope control is handled upstream; katana runs bounded depth as configured.
- Dry-run check: `katana -hc` (health-check).

---

## gowitness (Screenshots; optional)
- Repo: https://github.com/sensepost/gowitness
- Latest: 3.0.5
- JSONL output: via writers `--write-jsonl` and `--write-jsonl-file`

Planned invocation
```
# From file list
gowitness scan file \
  -f <live_urls.txt> \
  --threads <n> \
  --timeout <sec> \
  --screenshot-path ./work/<domain>/shots \
  --write-jsonl \
  --write-jsonl-file ./work/<domain>/shots/gowitness.jsonl
```

Integration notes
- Also supports `--write-db` (SQLite) and `--write-csv`; Hermetica will parse JSONL if enabled.
- Rate controls: `--threads` and `--delay`. Hermetica will cap via config `stages.screenshots.rate_limit_per_min`.
- Dry-run check: `gowitness --help`.

---

## Doctor / Dry-Run Strategy
Hermetica performs non-invasive checks:
- Version presence: run `<tool> -version` or `--version`.
- Health checks: use `-hc` where supported (httpx, dnsx, katana) without network operations.
- JSON sanity: run an echo of a known safe input (localhost or empty) only when safe and permitted by config.

Hermetica records validated tool versions into `run.meta.json` and fails hard if tools are missing or below the configured minimum.

